# **Классификация капиллярных сосудов глаза по снимкам щелевой офтальмологической лампы**

## **Источники**

[Краткий разбор источников](#разбор-источников)

### Исследованы
* [**"Simultaneous segmentation and classification of the retinal arteries and veins from color fundus images"**](https://arxiv.org/pdf/2209.09582.pdf)

* [**"AV-Net: Deep learning for fully automated artery-vein classification in optical coherence tomography angiography"**](https://arxiv.org/ftp/arxiv/papers/2006/2006.03742.pdf)

* [**"Joint Segmentation and Classification of Retinal Arteries/Veins from Fundus Images"**](https://arxiv.org/pdf/1903.01330.pdf)

### В процессе
* [**"Futuristic Variations and Analysis in Fundus Images Corresponding to Biological Traits"**](https://arxiv.org/pdf/2302.03839.pdf)

* [**"Fully Automated Artery-Vein ratio and vascular tortuosity measurement in retinal fundus images"**](https://arxiv.org/pdf/2301.01791.pdf)

### Полезное

[**Ссылка на оригинал шаблона дипломной работы**](https://github.com/SoprachevAK/SPBSTU-Latex-template-diploma)

* * *

## **Описание проекта**
## Общее описание
Проект представляет собой информационную систему. Система использует снимки человеческого глаза, сделанные с помощью щелевой офтальмологической лампы, и автоматизированно выполняет задачи распознавания и классификации капиллярных сосудов глаза.

## Постановка задачи
**Задача классификации капиллярных сосудов глаза по снимкам щелевой офтальмологической лампы с помощью машинного обучения формулируется следующим образом:**

* Дан набор снимков человеческого глаза, полученных с помощью щелевой офтальмологической лампы, на которых чётко различимы капиллярные сосуды. Требуется построить модель машинного обучения, которая будет классифицировать капиллярные сосуды на снимках в две категории: большие и малые.

**Для решения этой задачи необходимо произвести следующие шаги:**

1. Собрать и подготовить набор данных, содержащий снимки глаза с капиллярными сосудами, размеченные на две категории: большие и малые;


2. Разработать методы обработки изображений, которые помогут выделить капиллярные сосуды на снимках и извлечь признаки, необходимые для классификации;

2. Систематизировать и подробно описать признаки, необходимые для классификации;

3. Выбрать подходящий алгоритм машинного обучения и обучить модель на подготовленных данных;

4. Оценить качество работы модели на отложенной выборке и произвести ее настройку и улучшение, если это необходимо;

5. Провести тестирование модели на новых данных и оценить ее работоспособность и точность классификации.

* * *

## Входные данные

На вход системе поступают снимки человеческого глаза, полученные с помощью щелевой офтальмологической лампы. 
* **Требования к входным данным:**
  * Расширение файла: PNG.
  * Разрешение 1624 x 1232.
  * Цветовая модель изображения: 8-bit/color RGB.  

* * *
  
## Классификация

Классификация глазных сосудов может быть описана следующим алгоритмом:

1. На вход подаётся изображение человеческого глаза, полученное с помощью щелевой офтальмологической лампы;

2. Выполняется сегментация сосудов глаза;

3. Для каждого отдельного сосуда, полученного в результате алгоритма сегментации вычисляются метрики (длина и ширина сосуда) в пикселях;

4. Вычисленные метрики сосудов в пикселях переводятся в миллиметры;

5. Классификация происходит путём проверки, в каком диапазоне находится вычисленная ширина сосуда (ширина сосудов каждого из классов лежит в определённом диапазоне)


* * * 

## Вычисление метрик сосудов

Вычисление ширины сосуда с заданным шагом реализуется следующим алгоритмом:

1. Производится поиск центральной линии сосуда;

2. В центральную линию добавляются узлы с заданным шагом;

3. Строится нормаль к каждому узлу линии;

4. С использованием нормали вычисляется ширина (в пискелях) для каждого узла;

5. На выходе: цетральная линия и массив измерений.

Вычисление длины сосуда соответствует вычислению количества пикселей в центральной линии сосуда.

* * *

## Перевод единиц измерения

Поскольку программа вычисляет метрики сосудов в пикселях, возникает необходимость перевода единиц измерения из пикселей в миллиметры. Для реализации перевод единиц измерения создаётся матрица перевода. Матрица перевода создаётся на основе разметки эталонного снимка (снимка, на котором изображен макето человеческого глаза с миллиметровыми насечками);

Разметка эталонного снимка производится программе QuPath: инструментами выделяются большие области макета на снимке (области шириной 1 мм), выделенные области выгружаются в файл с разрешением .geojson;

Матрица перевода единиц измерения создаётся следующим алгоримтом:
 1. Тут будет алгоритм создания матрицы перевода

* * *

## **Разбор источников**

 Здесь будут выжимки из источников, а также опишу, что из какого источника мы можем подчерпнуть
